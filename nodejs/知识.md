# 知识

## IPC TCP/IP

IPC，全名Inter Process Communication即进程间通讯，在同一台机器上的两个进程就用IPC，不能跨物理机器。IPC包括共享内存、队列、信号量等几种方式，由于IPC通讯效率之高，所以大量的Unix下软件都用IPC通讯

主要IPC方法
- 文件
- 信号
- Berkeley套接字
- 消息队列
- 管道
- 命名管道
- 信号量 （信号量用于实现进程间的互斥与同步，而不是用于存储进程间通信数据。）
- 共享内存
- Message passing（不共享）
- Memory-mapped file

管道和命名管道
一、匿名管道
1) 由pipe系统调用，管道由父进程建立
2) 单工通信的
3) 在关系进程中进行(父进程和子进程、同一个父进程的两个子进程之间)
4) 管道位于内核空间，其实是一块缓存

二、命名管道(FIFO)
1) 两个没有任何关系的进程之间通信可通过命名管道进行数据传输，
2) 本质是内核中的一块缓存，另在文件系统中以一个特殊的设备文件(管道文件)存在。
3) 两种方式建立FIFO:
* 命令: mkfifo demo.pipe ==> 创建命名管道(命令内部调用mkfifo函数)
* 系统调用mkfifo(pathname, mode);
注: 命名管道必须读和写同时打开，否则单独读或者单独写会引发阻塞。

TCP/IP，全名Transmission Control Protocol/Internet Protocol即传输控制协议/网间网协议，TCP/IP可在同一台机子或两台物理机或不同操作平台之间的两个进程进行通讯。标准IPC/IP通讯过程：在主机1上，应用层将一串应用数据流传送给传输层；传输层将应用层的数据流截成分组，并加上TCP报头形成TCP段，送交网络层；在网络层给TCP段加上包括源、目的主机2 IP地址的IP报头，生成一个IP数据包，并将IP数据包送交链路层；链路层在其MAC帧的数据部分装上IP数据包，再加上源、目的主机2的MAC地址和帧头，并根据其目的MAC地址，将MAC帧发往目的主机2或IP路由器。在目的主机2，链路层将MAC帧的帧头去掉，并将IP数据包送交网络层；网络层检查IP报头，如果报头中校验和与计算结果不一致，则丢弃该IP数据包；若校验和与计算结果一致，则去掉IP报头，将TCP段送交传输层；传输层检查顺序号，判断是否是正确的TCP分组，然后检查TCP报头数据。若正确，则向源主机1发确认信息；若不正确或丢包，则向源主机1要求重发信息；在目的主机2，传输层去掉TCP报头，将排好顺序的分组组成应用数据流送给应用程序。这样目的主机2接收到的来自源主机1的字节流，就像是直接接收来自源主机1的字节流一样。
